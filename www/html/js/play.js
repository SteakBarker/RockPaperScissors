function getData(){sendAjax(function(a){var b=JSON.parse(a);$("#loading").hide();if(b["success"]==0){alert(b["error"])}var c=b["history"];var d=b["ppos"];var e=b["canPlay"];var f=b["p1Name"];var g=b["p2Name"];if(e){$("#moves").show();if(d==1){document.getElementById("result").innerHTML=didWin([c.charAt(c.length-2),c.charAt(c.length-1)]).toUpperCase();document.getElementById("yourName").innerHTML=f;document.getElementById("theirName").innerHTML=g}else{document.getElementById("result").innerHTML=didWin([c.charAt(c.length-1),c.charAt(c.length-2)]).toUpperCase();document.getElementById("yourName").innerHTML=g;document.getElementById("theirName").innerHTML=f}}else{$("#moves").hide();document.getElementById("result").innerHTML="PENDING"}if(d==1){document.getElementById("yourName").innerHTML=f;document.getElementById("theirName").innerHTML=g}else{document.getElementById("yourName").innerHTML=g;document.getElementById("theirName").innerHTML=f}document.getElementById("table").innerHTML="<tr><td>Your Move</td><td>Result</td><td>Their Move</td></tr>";for(var i=0;i<c.length-1;i+=2){var h;var j;if(d==1){h=c[i];j=c[i+1]}else{h=c[i+1];j=c[i]}var k=document.getElementById("table");var l=k.insertRow(1);var m=l.insertCell(0);var n=l.insertCell(1);var o=l.insertCell(2);m.innerHTML=moveToName(h);n.innerHTML=didWin([h,j]);o.innerHTML=moveToName(j)}})}function sendAjax(b){$.ajax({url:"gameData.php",type:'POST',data:{id:id,userid:p_id,},beforeSend:function(){$("#loading").show()},success:function(a){b(a)},error:function(){$("#loading").hide();alert("Request Failed")},timeout:5000})}function moveToName(a){if(a=="r"){return"Rock"}else if(a=="p"){return"Paper"}else{return"Scissors"}}function play(b){$.ajax({url:"makeMove.php",type:'POST',data:{id:id,userid:p_id,move:b,},success:function(a){getData()}})}function didWin(a){for(var i=0;i<2;i++){switch(a[i]){case"r":a[i]=0;break;case"p":a[i]=1;break;case"s":a[i]=2;break}}if(a[0]===a[1]){return"tie"}else if(a[0]+1===a[1]||(a[0]==2&&a[1]==0)){return"lost"}else{return"won"}}function goHome(){window.location="index.html"}$(document).ready(function(){getData()});